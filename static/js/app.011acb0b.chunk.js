(this["webpackJsonp@dhis2/app-shell"]=this["webpackJsonp@dhis2/app-shell"]||[]).push([[127],{203:function(e,a,t){e.exports={svg:"SwitchIcon_svg__1uzBk"}},204:function(e,a,t){e.exports={link:"Link_link__2mSUv"}},212:function(e,a,t){e.exports={header:"JobList_header__23tFt",headerTitle:"JobList_headerTitle__21D__",headerLink:"JobList_headerLink__2zepi",headerLinkIcon:"JobList_headerLinkIcon__XdfBB",controlContainer:"JobList_controlContainer__3Yzj_",controlRight:"JobList_controlRight__38lfB"}},213:function(e,a,t){e.exports={list:"FormErrorBox_list__3BejY"}},214:function(e,a,t){e.exports={headerTitle:"ParameterFields_headerTitle__IBF76"}},215:function(e,a,t){e.exports={formButtonContainer:"JobAddForm_formButtonContainer__1MLSp",saveButton:"JobAddForm_saveButton__RfxZ9"}},216:function(e,a,t){e.exports={formButtonContainer:"JobEditForm_formButtonContainer__2b6Fi",deleteButton:"JobEditForm_deleteButton__VQxBE",saveButton:"JobEditForm_saveButton__278Ab"}},217:function(e,a,t){e.exports={wrapper:"JobDetails_wrapper__1-YkO",title:"JobDetails_title__1Cht7",details:"JobDetails_details__2HITJ"}},218:function(e,a,t){e.exports={pageHeader:"JobEdit_pageHeader__3Fywp",pageHeaderButton:"JobEdit_pageHeaderButton__29yjJ",pageHeaderTitle:"JobEdit_pageHeaderTitle__jZrIG",card:"JobEdit_card__2QqEg",cardHeader:"JobEdit_cardHeader__Mv_cj",cardHeaderTitle:"JobEdit_cardHeaderTitle__29Y64",cardHeaderInfo:"JobEdit_cardHeaderInfo__3VWZt",cardHeaderLink:"JobEdit_cardHeaderLink__2frj7",jobDetails:"JobEdit_jobDetails__194v-"}},219:function(e,a,t){e.exports={pageHeader:"JobView_pageHeader__3d3IR",pageHeaderButton:"JobView_pageHeaderButton__2VF9Z",pageHeaderTitle:"JobView_pageHeaderTitle__3wHyg",card:"JobView_card__3LlD0",cardHeader:"JobView_cardHeader__3v0pX",cardHeaderTitle:"JobView_cardHeaderTitle__tPEnV",cardHeaderInfo:"JobView_cardHeaderInfo__j1GsD",cardHeaderLink:"JobView_cardHeaderLink__86M36",jobDetails:"JobView_jobDetails__3cu4z"}},220:function(e,a,t){e.exports={pageHeader:"JobAdd_pageHeader__2NZzc",pageHeaderButton:"JobAdd_pageHeaderButton__Xg_R9",pageHeaderTitle:"JobAdd_pageHeaderTitle__1RMl0",card:"JobAdd_card__1HH6H",cardHeader:"JobAdd_cardHeader__1D3sS",cardHeaderTitle:"JobAdd_cardHeaderTitle__2TG9a",cardHeaderInfo:"JobAdd_cardHeaderInfo__vq_Y1",cardHeaderLink:"JobAdd_cardHeaderLink__2CzPt"}},221:function(e,a,t){e.exports={noticeBoxWrapper:"AuthWall_noticeBoxWrapper__1ums5"}},222:function(e,a,t){e.exports={wrapper:"PageWrapper_wrapper__t-CJy"}},223:function(e,a,t){},228:function(e,a,t){"use strict";t.r(a);var r={};t.r(r),t.d(r,"useAllJobs",(function(){return h})),t.d(r,"useAllParameterOptions",(function(){return g})),t.d(r,"useAllJobTypes",(function(){return _})),t.d(r,"useRefetchJobs",(function(){return y})),t.d(r,"useJobFilter",(function(){return f})),t.d(r,"useShowSystemJobs",(function(){return v})),t.d(r,"useJobListJobs",(function(){return x})),t.d(r,"useJob",(function(){return j})),t.d(r,"useJobType",(function(){return T})),t.d(r,"useJobTypeParameters",(function(){return C})),t.d(r,"useParameterOptions",(function(){return N}));var n=t(1),s=t.n(n),l=t(181),o=t(182),c=t(180),i=t(13);var d=Object(n.createContext)({jobs:{},jobTypes:{},parameterOptions:{},refetchJobs:()=>{throw new Error("Store context needs a valid provider")}});const m={jobs:{resource:"jobConfigurations",params:{fields:"*",paging:!1}}},u={jobTypes:{resource:"jobConfigurations/jobTypes",params:{fields:"*",paging:!1}}},p={skipTableTypes:{resource:"analytics/tableTypes"},validationRuleGroups:{resource:"validationRuleGroups",params:{paging:!1}},pushAnalysis:{resource:"pushAnalysis",params:{paging:!1}},predictors:{resource:"predictors",params:{paging:!1}},predictorGroups:{resource:"predictorGroups",params:{paging:!1}}},{node:b}=c.a;var E=({children:e})=>{const a=Object(n.useState)(""),t=Object(n.useState)(!1),r=Object(i.e)(m),o=Object(i.e)(u),c=Object(i.e)(p);if(r.loading||o.loading||c.loading)return s.a.createElement(l.o,null,s.a.createElement(l.e,null,s.a.createElement(l.g,null)));const b=r.error||o.error||c.error;if(b)throw b;const{jobConfigurations:E}=r.data.jobs,{jobTypes:h}=o.data.jobTypes,{skipTableTypes:g,validationRuleGroups:{validationRuleGroups:_},pushAnalysis:{pushAnalysis:y},predictors:{predictors:f},predictorGroups:{predictorGroups:v}}=c.data,x={skipTableTypes:g,validationRuleGroups:_,pushAnalysis:y,predictors:f,predictorGroups:v};return s.a.createElement(d.Provider,{value:{jobs:E,jobTypes:h,parameterOptions:x,refetchJobs:r.refetch,jobFilter:a,showSystemJobs:t}},e)};const h=()=>Object(n.useContext)(d).jobs,g=()=>Object(n.useContext)(d).parameterOptions,_=()=>Object(n.useContext)(d).jobTypes,y=()=>Object(n.useContext)(d).refetchJobs,f=()=>Object(n.useContext)(d).jobFilter,v=()=>Object(n.useContext)(d).showSystemJobs,x=()=>{const[e]=f(),[a]=v();return h().filter(a=>a.displayName.toLowerCase().includes(e.toLowerCase())).filter(e=>!!a||e.configurable)},j=e=>h().find(a=>a.id===e),T=e=>_().find(a=>a.jobType===e),C=e=>{const a=T(e);return"jobParameters"in a?a.jobParameters:[]},N=e=>g()[e];var S=t(8),O=t.n(S);var L={DATA_VALUE:O.a.t("Data value"),COMPLETENESS:O.a.t("Completeness"),COMPLETENESS_TARGET:O.a.t("Completeness target"),ORG_UNIT_TARGET:O.a.t("Org unit target"),EVENT:O.a.t("Event"),ENROLLMENT:O.a.t("Enrollment"),VALIDATION_RESULT:O.a.t("Validation result")};var A={ANALYTICS_TABLE:O.a.t("Analytics table"),CONTINUOUS_ANALYTICS_TABLE:O.a.t("Continuous analytics table"),CREDENTIALS_EXPIRY_ALERT:O.a.t("Credentials expiry alert"),DATA_INTEGRITY:O.a.t("Data integrity"),DATA_SET_NOTIFICATION:O.a.t("Dataset notification"),DATA_STATISTICS:O.a.t("Data statistics"),DATA_SYNC:O.a.t("Data synchronization"),EVENT_PROGRAMS_DATA_SYNC:O.a.t("Event programs data sync"),FILE_RESOURCE_CLEANUP:O.a.t("File resource clean up"),META_DATA_SYNC:O.a.t("Metadata synchronization"),MONITORING:O.a.t("Monitoring"),PREDICTOR:O.a.t("Predictor"),PROGRAM_NOTIFICATIONS:O.a.t("Program notifications"),PUSH_ANALYSIS:O.a.t("Push analysis"),REMOVE_EXPIRED_RESERVED_VALUES:O.a.t("Remove expired reserved values"),RESOURCE_TABLE:O.a.t("Resource table"),SEND_SCHEDULED_MESSAGE:O.a.t("Send scheduled message"),TRACKER_PROGRAMS_DATA_SYNC:O.a.t("Tracker programs data sync"),VALIDATION_RESULTS_NOTIFICATION:O.a.t("Validation results notification"),DISABLE_INACTIVE_USERS:O.a.t("Disable inactive users")};var J={COMPLETED:O.a.t("Completed"),DISABLED:O.a.t("Disabled"),DONE:O.a.t("Done"),FAILED:O.a.t("Failed"),NOT_STARTED:O.a.t("Not started"),RUNNING:O.a.t("Running"),SCHEDULED:O.a.t("Scheduled"),STOPPED:O.a.t("Stopped")},k=t(2),F=t.n(k),w=t(183),I=t(7),H=t.n(I),R=t(203),D=t.n(R);var P=function({className:e}){return s.a.createElement("svg",{viewBox:"0 0 42 22",xmlns:"http://www.w3.org/2000/svg",className:H()(D.a.svg,e)},s.a.createElement("path",{d:"M0,11 L0,11 C0,4.92486775 4.92076837,0 11.0075657,0 L30.9924343,0 C37.071745,0 42,4.923532 42,11 L42,11 C42,17.0751322 37.0792316,22 30.9924343,22 L11.0075657,22 C4.92825504,22 0,17.0791222 0,11 L0,11 Z",className:"background",fill:"red"}),s.a.createElement("path",{d:"M30.9924343,0 C36.975248,0 41.8432574,4.76846989 41.99629,10.7115309 L42,11 C42,17.0751322 37.0792316,22 30.9924343,22 L11.0075657,22 C5.02475203,22 0.156742552,17.2341007 0.00370995454,11.2885915 L0,11 C0,4.92486775 4.92076837,0 11.0075657,0 L30.9924343,0 Z M30.9924343,1 L11.0075657,1 C5.47559009,1 0.99991738,5.47461611 0.99991738,10.9871457 L1.00337887,11.2628608 C1.14271146,16.6761076 5.5768313,21 11.0075657,21 L30.9924343,21 C36.5244099,21 41.0000827,16.5253839 41.0000827,11.0128598 L40.9966214,10.7372722 C40.8572703,5.32553352 36.4222391,1 30.9924343,1 Z",className:"border"}),s.a.createElement("path",{d:"M27.7071068,7.29289322 L30,9.585 L32.2928932,7.29289322 C32.6533772,6.93240926 33.2206082,6.90467972 33.6128994,7.20970461 L33.7071068,7.29289322 C34.0976311,7.68341751 34.0976311,8.31658249 33.7071068,8.70710678 L33.7071068,8.70710678 L31.415,11 L33.7071068,13.2928932 C34.0976311,13.6834175 34.0976311,14.3165825 33.7071068,14.7071068 C33.3165825,15.0976311 32.6834175,15.0976311 32.2928932,14.7071068 L30,12.415 L27.7071068,14.7071068 C27.3466228,15.0675907 26.7793918,15.0953203 26.3871006,14.7902954 L26.2928932,14.7071068 C25.9023689,14.3165825 25.9023689,13.6834175 26.2928932,13.2928932 L26.2928932,13.2928932 L28.585,11 L26.2928932,8.70710678 C25.9023689,8.31658249 25.9023689,7.68341751 26.2928932,7.29289322 C26.6834175,6.90236893 27.3165825,6.90236893 27.7071068,7.29289322 Z",className:"cross",fill:"#FFFFFF"}),s.a.createElement("path",{d:"M7.74451387,10.0285252 C7.39595738,10.1198564 7.12375034,10.3923519 7.03251575,10.7412777 C6.94128115,11.0902035 7.04521722,11.4612586 7.30437605,11.7118278 L10.2982384,14.7078028 C10.6875399,15.0973991 11.3185977,15.0973991 11.7078992,14.7078028 L16.695624,8.71585285 C16.9547828,8.46528367 17.0587189,8.09422851 16.9674843,7.74530271 C16.8762497,7.39637691 16.6040426,7.12388146 16.2554861,7.0325502 C15.9069296,6.94121893 15.5362672,7.04526513 15.2859632,7.30469855 L11.0030688,12.5910713 L8.71403676,10.3006735 C8.46373279,10.0412401 8.09307036,9.9371939 7.74451387,10.0285252 Z",className:"checkmark"}),s.a.createElement("path",{d:"M11,20 C15.9705627,20 20,15.9705627 20,11 C20,6.02943725 15.9705627,2 11,2 C6.02943725,2 2,6.02943725 2,11 C2,15.9705627 6.02943725,20 11,20 Z",className:"handle handle-unchecked"}),s.a.createElement("path",{d:"M31,20 C35.9705627,20 40,15.9705627 40,11 C40,6.02943725 35.9705627,2 31,2 C26.0294373,2 22,6.02943725 22,11 C22,15.9705627 26.0294373,20 31,20 Z",className:"handle handle-checked"}))};class B extends n.Component{constructor(...e){super(...e),this.ref=Object(n.createRef)(),this.handleChange=e=>{this.props.onChange&&this.props.onChange(this.createHandlerPayload(),e)},this.handleBlur=e=>{this.props.onBlur&&this.props.onBlur(this.createHandlerPayload(),e)},this.handleFocus=e=>{this.props.onFocus&&this.props.onFocus(this.createHandlerPayload(),e)}}componentDidMount(){this.props.initialFocus&&this.ref.current.focus()}createHandlerPayload(){return{value:this.props.value,name:this.props.name,checked:!this.props.checked}}render(){const{checked:e=!1,className:a,disabled:t,error:r,label:n,name:l,tabIndex:o,valid:c,value:i,warning:d,dense:m,dataTest:u,ariaLabel:p}=this.props,b=H()({checked:e,disabled:t,valid:c,error:r,warning:d,dense:m});return s.a.createElement("label",{"data-test":u,className:F.a.dynamic([["3159185573",[w.colors.grey900,w.theme.disabled,w.colors.blue600]]])+" "+(H()(a,{disabled:t,dense:m})||"")},s.a.createElement("input",{type:"checkbox",ref:this.ref,role:"switch",name:l,value:i,checked:e,disabled:t,tabIndex:o,onChange:this.handleChange,onFocus:this.handleFocus,onBlur:this.handleBlur,"aria-label":p,className:F.a.dynamic([["3159185573",[w.colors.grey900,w.theme.disabled,w.colors.blue600]]])}),s.a.createElement("div",{className:F.a.dynamic([["3159185573",[w.colors.grey900,w.theme.disabled,w.colors.blue600]]])+" "+(H()("icon",{dense:m})||"")},s.a.createElement(P,{className:b})),n,s.a.createElement(F.a,{id:"3159185573",dynamic:[w.colors.grey900,w.theme.disabled,w.colors.blue600]},["label.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:start;-webkit-justify-content:flex-start;-ms-flex-pack:start;justify-content:flex-start;cursor:pointer;color:".concat(w.colors.grey900,";font-size:16px;line-height:20px;}"),"label.dense.__jsx-style-dynamic-selector{font-size:14px;line-height:16px;}","label.disabled.__jsx-style-dynamic-selector{cursor:not-allowed;color:".concat(w.theme.disabled,";}"),"input.__jsx-style-dynamic-selector{opacity:0;position:absolute;height:18px;width:35px;margin-left:3px;}","label.dense.__jsx-style-dynamic-selector input.__jsx-style-dynamic-selector{height:14px;width:27px;}",".icon.__jsx-style-dynamic-selector{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;margin-right:5px;border:2px solid transparent;padding:1px;border-radius:14px;}","label.dense.__jsx-style-dynamic-selector .icon.__jsx-style-dynamic-selector{margin-right:3px;border-radius:12px;}","input.__jsx-style-dynamic-selector:focus+.icon.__jsx-style-dynamic-selector{border-color:".concat(w.colors.blue600,";}")]))}}var M=B,G=t(185),U=t(204),V=t.n(U);var W=e=>s.a.createElement(G.a,Object.assign({className:V.a.link},e));const Y={resource:"jobConfigurations",id:({id:e})=>e,type:"update",partial:!0,data:({enabled:e})=>({enabled:e})},{bool:q,string:z}=c.a;var Z=({id:e,checked:a,disabled:t})=>{const[n,{loading:l}]=Object(i.d)(Y),o=r.useRefetchJobs(),c=!a;return s.a.createElement(M,{name:"toggle-job-".concat(e),disabled:t||l,checked:a,onChange:()=>{n({id:e,enabled:c}).then(()=>o())},ariaLabel:O.a.t("Toggle job")})},X=t(193);var K=Object(X.b)();const{string:Q}=c.a;var $=({id:e})=>s.a.createElement(l.p,{dense:!0,onClick:()=>K.push("/edit/".concat(e)),label:O.a.t("Edit")});const{string:ee}=c.a;var ae=({id:e})=>s.a.createElement(l.p,{dense:!0,onClick:()=>K.push("/view/".concat(e)),label:O.a.t("View")});const te=[{label:O.a.t("Every hour"),value:"0 0 * ? * *"},{label:O.a.t("Every day at midnight"),value:"0 0 1 ? * *"},{label:O.a.t("Every day at 3 am"),value:"0 0 3 ? * *"},{label:O.a.t("Every day at noon"),value:"0 0 12 ? * MON-FRI"},{label:O.a.t("Every week"),value:"0 0 3 ? * MON"}],{func:re}=c.a;var ne=({setCron:e,hideModal:a})=>{const[t,r]=Object(n.useState)("");return s.a.createElement(l.q,{open:!0,small:!0,onClose:a},s.a.createElement(l.t,null,O.a.t("Choose a preset time/interval")),s.a.createElement(l.s,null,te.map(e=>s.a.createElement(l.x,Object.assign({},e,{checked:t===e.value,key:e.value,onChange:({value:e})=>r(e)})))),s.a.createElement(l.r,null,s.a.createElement(l.c,{end:!0},s.a.createElement(l.b,{secondary:!0,onClick:a,name:"hide-modal"},O.a.t("Cancel")),s.a.createElement(l.b,{primary:!0,name:"insert-preset",disabled:!t,onClick:()=>{a(),e(t)}},O.a.t("Insert preset")))))};const se={resource:"jobConfigurations",id:({id:e})=>e,type:"delete"},{func:le,string:oe}=c.a;var ce=({id:e,hideModal:a,onSuccess:t})=>{const[r]=Object(i.d)(se);return s.a.createElement(l.q,{open:!0,small:!0,onClose:a},s.a.createElement(l.s,null,O.a.t("Are you sure you want to delete this job?")),s.a.createElement(l.r,null,s.a.createElement(l.c,{end:!0},s.a.createElement(l.b,{name:"hide-modal",secondary:!0,onClick:a},O.a.t("Cancel")),s.a.createElement(l.b,{name:"delete-job-".concat(e),destructive:!0,onClick:()=>{r({id:e}).then(()=>{a(),t()})}},O.a.t("Delete")))))};const{func:ie}=c.a;var de=({hideModal:e})=>s.a.createElement(l.q,{open:!0,small:!0,onClose:e},s.a.createElement(l.s,null,O.a.t("Are you sure you want to discard this form?")),s.a.createElement(l.r,null,s.a.createElement(l.c,{end:!0},s.a.createElement(l.b,{name:"cancel-discard-form",secondary:!0,onClick:e},O.a.t("Cancel")),s.a.createElement(l.b,{name:"discard-form",destructive:!0,onClick:()=>{e(),K.push("/")}},O.a.t("Discard")))));const{func:me,string:ue}=c.a;var pe=({id:e,hideModal:a})=>{const t=Object(i.c)(),n={jobs:{resource:"jobConfigurations/".concat(e,"/execute")}},o=r.useRefetchJobs();return s.a.createElement(l.q,{open:!0,small:!0,onClose:a},s.a.createElement(l.s,null,O.a.t("Are you sure you want to run this job?")),s.a.createElement(l.r,null,s.a.createElement(l.c,{end:!0},s.a.createElement(l.b,{name:"hide-modal",secondary:!0,onClick:a},O.a.t("Cancel")),s.a.createElement(l.b,{name:"run-job-".concat(e),primary:!0,onClick:()=>{t.query(n).then(()=>{a(),o()})}},O.a.t("Run")))))};const{string:be}=c.a;var Ee=({id:e})=>{const{enabled:a}=r.useJob(e),[t,o]=Object(n.useState)(!1);return s.a.createElement(s.a.Fragment,null,s.a.createElement(l.p,{dense:!0,onClick:()=>{o(!0)},disabled:!a,label:O.a.t("Run manually")}),t&&s.a.createElement(pe,{id:e,hideModal:()=>o(!1)}))};const{string:he}=c.a;var ge=({id:e})=>{const[a,t]=Object(n.useState)(!1),o=r.useRefetchJobs();return s.a.createElement(s.a.Fragment,null,s.a.createElement(l.p,{dense:!0,destructive:!0,onClick:()=>{t(!0)},label:O.a.t("Delete")}),a&&s.a.createElement(ce,{id:e,hideModal:()=>t(!1),onSuccess:o}))};const _e=({id:e,configurable:a})=>s.a.createElement(l.i,{small:!0,component:s.a.createElement(l.k,null,a?s.a.createElement($,{id:e}):s.a.createElement(ae,{id:e}),a&&s.a.createElement(Ee,{id:e}),a&&s.a.createElement(ge,{id:e}))},O.a.t("Actions"));_e.defaultProps={configurable:!1};const{string:ye,bool:fe}=c.a;var ve=_e;const{string:xe}=c.a;var je=({status:e})=>{switch(e){case"STOPPED":case"DISABLED":return s.a.createElement(l.K,null,J[e]);case"RUNNING":case"NOT_STARTED":case"SCHEDULED":return s.a.createElement(l.K,{neutral:!0},J[e]);case"FAILED":return s.a.createElement(l.K,{negative:!0},J[e]);case"DONE":return s.a.createElement(l.K,{positive:!0},J[e]);default:return null}},Te=t(27),Ce=t.n(Te);const Ne=({nextExecutionTime:e,enabled:a})=>{if(!a||!e)return"-";const t=Ce()(Date.now()),r=Ce.a.utc(e);return r.isSameOrBefore(t,"minute")?O.a.t("Not scheduled"):t.to(r)},{bool:Se,string:Oe}=c.a;Ne.propTypes={enabled:Se.isRequired,nextExecutionTime:Oe};var Le=Ne,Ae=t(210),Je=t.n(Ae);const ke=["MON","TUE","WED","THU","FRI","SAT","SUN"],Fe=["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],we=(e,a,t)=>e>=a&&e<=t,Ie=e=>"*"===e,He=e=>"?"===e,Re=(e,a,t)=>Ie(e)||we(e,a,t)||((e,a,t)=>{const r=e.split("-");return!(!r||2!==r.length)&&(we(r[0],a,t)&&we(r[1],a,t)&&r[0]<=r[1])})(e,a,t)||((e,a,t)=>{const r=e.split("/");return!(!r||2!==r.length)&&((Ie(r[0])||we(r[0],a,t))&&we(r[1],a,t))})(e,a,t),De=e=>Re(e,1,12)||(e=>{const a=e.split("-"),[t,r]=a.map(e=>Fe.indexOf(e));return-1!==t&&void 0===r||-1!==t&&-1!==r&&t<=r})(e),Pe=e=>Re(e,1,7)||(e=>{const a=e.split("-"),[t,r]=a.map(e=>ke.indexOf(e));return-1!==t&&void 0===r||-1!==t&&-1!==r&&t<=r})(e)||He(e);var Be=e=>{if(!e)return!1;const a=e.trim().split(" ");return!!(e=>e&&6===e.length)(a)&&(t=a[0],Re(t,0,59)&&(e=>Re(e,0,59))(a[1])&&(e=>Re(e,0,23))(a[2])&&(e=>Re(e,0,31)||He(e))(a[3])&&De(a[4])&&Pe(a[5]));var t};var Me=e=>"string"===typeof e&&e.length>0?Be(e)?void 0:O.a.t("Please enter a valid CRON expression"):O.a.t("A CRON expression is required");var Ge=e=>{const a=O.a.language||"en";return e&&Be(e)?Je.a.toString(e,{locale:a}):""};const Ue=({cronExpression:e,schedulingType:a,delay:t})=>{switch(a){case"CRON":return Ge(e);case"FIXED_DELAY":return O.a.t("{{ delay }} seconds after last run",{delay:t});default:return"-"}},{string:Ve,number:We}=c.a;Ue.propTypes={schedulingType:Ve.isRequired,cronExpression:Ve,delay:We};var Ye=Ue;const{shape:qe,string:ze,bool:Ze,number:Xe}=c.a;var Ke=({job:{id:e,displayName:a,jobType:t,cronExpression:r,delay:n,jobStatus:o,nextExecutionTime:c,schedulingType:i,enabled:d,configurable:m}})=>s.a.createElement(l.I,null,s.a.createElement(l.F,{role:"rowheader"},a),s.a.createElement(l.F,null,A[t]),s.a.createElement(l.F,null,s.a.createElement(Ye,{cronExpression:r,delay:n,schedulingType:i})),s.a.createElement(l.F,null,s.a.createElement(Le,{nextExecutionTime:c,enabled:d})),s.a.createElement(l.F,null,s.a.createElement(je,{status:o})),s.a.createElement(l.F,null,s.a.createElement(Z,{id:e,checked:d,disabled:!m})),s.a.createElement(l.F,null,s.a.createElement(ve,{id:e,configurable:m})));const{object:Qe,arrayOf:$e}=c.a;var ea=({jobs:e})=>s.a.createElement(l.D,null,s.a.createElement(l.H,null,s.a.createElement(l.J,null,s.a.createElement(l.G,null,O.a.t("Job name")),s.a.createElement(l.G,null,O.a.t("Type")),s.a.createElement(l.G,null,O.a.t("Schedule")),s.a.createElement(l.G,null,O.a.t("Next run")),s.a.createElement(l.G,null,O.a.t("Status")),s.a.createElement(l.G,null,O.a.t("On/off")),s.a.createElement(l.G,null))),s.a.createElement(l.E,null,0===e.length?s.a.createElement(l.I,null,s.a.createElement(l.F,null,O.a.t("No jobs to display"))):e.map(e=>s.a.createElement(Ke,{key:e.id,job:e})))),aa=t(212),ta=t.n(aa);const{bool:ra,object:na,string:sa,arrayOf:la,func:oa}=c.a;var ca=({jobs:e,showSystemJobs:a,setShowSystemJobs:t,jobFilter:r,setJobFilter:n})=>s.a.createElement(s.a.Fragment,null,s.a.createElement("header",{className:ta.a.header},s.a.createElement("h1",{className:ta.a.headerTitle},O.a.t("Scheduled jobs")),s.a.createElement("a",{href:"https://docs.dhis2.org/en/use/user-guides/dhis-core-version-236/maintaining-the-system/scheduling.html",className:ta.a.headerLink,target:"_blank",rel:"noopener noreferrer"},s.a.createElement("span",{className:ta.a.headerLinkIcon},s.a.createElement(l.l,null)),O.a.t("About job configuration"))),s.a.createElement(l.d,null,s.a.createElement("div",{className:ta.a.controlContainer},s.a.createElement(l.m,{dataTest:"job-filter-input",label:O.a.t("Filter jobs"),onChange:({value:e})=>{n(e)},value:r,type:"search",role:"searchbox",name:"job-filter"}),s.a.createElement("div",{className:ta.a.controlRight},s.a.createElement(l.f,{dataTest:"job-toggle-checkbox",checked:a,label:O.a.t("Include system jobs in list"),onChange:({checked:e})=>{t(e)}}),s.a.createElement(W,{to:"/add"},O.a.t("New job")))),s.a.createElement(ea,{jobs:e})));var ia=()=>{const[e,a]=r.useJobFilter(),[t,n]=r.useShowSystemJobs(),l=r.useJobListJobs();return s.a.createElement(ca,{jobs:l,showSystemJobs:t,setShowSystemJobs:n,jobFilter:e,setJobFilter:a})};const da=({setCron:e,small:a})=>{const[t,r]=Object(n.useState)(!1);return s.a.createElement(s.a.Fragment,null,s.a.createElement(l.b,{onClick:()=>r(!0),small:a},O.a.t("Choose from preset times")),t&&s.a.createElement(ne,{hideModal:()=>r(!1),setCron:e}))};da.defaultProps={small:!1};const{func:ma,bool:ua}=c.a;var pa=da;const{string:ba,func:Ea}=c.a;var ha=({id:e,onSuccess:a})=>{const[t,r]=Object(n.useState)(!1);return s.a.createElement(s.a.Fragment,null,s.a.createElement(l.b,{destructive:!0,onClick:()=>r(!0)},O.a.t("Delete job")),t&&s.a.createElement(ce,{id:e,hideModal:()=>r(!1),onSuccess:a}))};const ga=({shouldConfirm:e,children:a,small:t,className:r})=>{const[o,c]=Object(n.useState)(!1),i=e?()=>c(!0):()=>K.push("/");return s.a.createElement(s.a.Fragment,null,s.a.createElement(l.b,{onClick:i,small:t,className:r},a),o&&s.a.createElement(de,{hideModal:()=>c(!1)}))};ga.defaultProps={className:"",shouldConfirm:!1,small:!1};const{string:_a,bool:ya}=c.a;var fa=ga;const{FORM_ERROR:va}=l.j;var xa=e=>{const{details:{response:a}}=e,t={},r=[];return a.errorReports&&a.errorReports.length&&a.errorReports.forEach(e=>{e.errorProperty?t[e.errorProperty]=e.message:r.push(e.message)}),r.length>0&&(t[va]=r),t};const ja={resource:"jobConfigurations",type:"create",data:({job:e})=>e};var Ta=()=>{const{refetchJobs:e}=Object(n.useContext)(d),a=Object(i.c)();return[t=>a.mutate(ja,{variables:{job:t}}).then(()=>{K.push("/"),e()}).catch(e=>{if("access"===e.type)return xa(e);throw e})]};const Ca={resource:"jobConfigurations",type:"update",id:({id:e})=>e,data:({job:e})=>e};var Na=({id:e})=>{const{refetchJobs:a}=Object(n.useContext)(d),t=Object(i.c)();return[r=>t.mutate(Ca,{variables:{job:r,id:e}}).then(()=>{K.push("/"),a()}).catch(e=>{if("access"===e.type)return xa(e);throw e})]},Sa=t(213),Oa=t.n(Sa);const{array:La}=c.a;var Aa=({submitError:e})=>e.length>0?s.a.createElement(l.w,{error:!0,title:O.a.t("Something went wrong whilst creating your job")},s.a.createElement("ul",{className:Oa.a.list},e.map(e=>s.a.createElement("li",{key:e},e)))):null;const{Field:Ja}=l.y,ka=Object(l.L)(l.P,l.N);var Fa=()=>s.a.createElement(Ja,{name:"name",component:l.n,validate:ka,label:O.a.t("Name"),type:"text",required:!0});const{Field:wa}=l.y,Ia=Object(l.L)(l.P,l.N);var Ha=()=>{const e=r.useAllJobTypes().map(({jobType:e})=>({value:e,label:A[e]}));return s.a.createElement(wa,{name:"jobType",validate:Ia,component:l.A,options:e,label:O.a.t("Job type"),required:!0})};const Ra=e=>"number"===typeof e?e.toString():e,{Field:Da}=l.y,{string:Pa}=c.a;var Ba=({label:e,name:a,parameterName:t})=>{const n=r.useParameterOptions(t);if(0===n.length)return s.a.createElement(l.u,{disabled:!0,helpText:O.a.t("No options available"),label:e});const o=n.map(e=>({value:e,label:L[e]||e}));return s.a.createElement(Da,{name:a,component:l.v,options:o,label:e})};const{Field:Ma}=l.y,{string:Ga}=c.a;var Ua=({label:e,name:a,parameterName:t})=>{const n=r.useParameterOptions(t);if(0===n.length)return s.a.createElement(l.u,{disabled:!0,helpText:O.a.t("No options available"),label:e});const o=n.map(({id:e,displayName:a})=>({value:e,label:a}));return s.a.createElement(Ma,{name:a,component:l.v,options:o,label:e})},Va=t(214),Wa=t.n(Va);const{Field:Ya}=l.y,{string:qa}=c.a;var za=({jobType:e})=>{const a=r.useJobTypeParameters(e);if(0===a.length)return null;const t=a.map(({fieldName:e,name:a,klass:t})=>{const r={label:e,name:"".concat("jobParameters",".").concat(a)};let n=null;if("skipTableTypes"===a)return s.a.createElement(l.a,{marginTop:"16px",key:a},s.a.createElement(Ba,Object.assign({},r,{parameterName:a})));switch(t){case"java.lang.String":n=s.a.createElement(Ya,Object.assign({},r,{component:l.n,type:"text"}));break;case"java.lang.Boolean":n=s.a.createElement(Ya,Object.assign({},r,{component:l.C,type:"checkbox"}));break;case"java.lang.Integer":n=s.a.createElement(Ya,Object.assign({},r,{component:l.n,format:Ra,type:"number"}));break;case"java.util.List":n=s.a.createElement(Ua,Object.assign({},r,{parameterName:a}))}return s.a.createElement(l.a,{marginTop:"16px",key:a},n)});return s.a.createElement(s.a.Fragment,null,s.a.createElement("header",null,s.a.createElement("h4",{className:Wa.a.headerTitle},O.a.t("Parameters"))),t)};const{Field:Za,useFormState:Xa,useForm:Ka}=l.y,Qa=Me;var $a=()=>{const e=Ka(),{values:a}=Xa({subscription:{values:!0}}),t=a.cronExpression,r=Ge(t);return s.a.createElement(s.a.Fragment,null,s.a.createElement(Za,{component:l.n,name:"cronExpression",validate:Qa,label:O.a.t("CRON Expression"),type:"text",helpText:r,required:!0}),s.a.createElement(l.a,{marginTop:"8px"},s.a.createElement(pa,{setCron:a=>e.change("cronExpression",a),small:!0})))};const{Field:et}=l.y,at=Object(l.L)(l.O,l.N,Object(l.M)(1,86400));var tt=()=>s.a.createElement(et,{component:l.n,name:"delay",validate:at,label:O.a.t("Delay"),type:"number",format:Ra,helpText:O.a.t("Delay in seconds ({{ lowerbound }} - {{ upperbound }})",{lowerbound:1,upperbound:86400}),required:!0});const{string:rt}=c.a;var nt=({jobType:e})=>{switch(r.useJobType(e).schedulingType){case"CRON":return s.a.createElement($a,null);case"FIXED_DELAY":return s.a.createElement(tt,null);default:return null}};const st="jobType";var lt=t(215),ot=t.n(lt);const{useForm:ct}=l.y,it=({handleSubmit:e,pristine:a,submitting:t,submitError:r,hasSubmitErrors:o,values:c,setIsPristine:i})=>{const{subscribe:d}=ct();Object(n.useEffect)(()=>d(({pristine:e})=>i(e),{pristine:!0}));const m=c[st],u=t?s.a.createElement(l.g,{small:!0}):null;return s.a.createElement("form",{onSubmit:e},s.a.createElement(l.a,{maxWidth:"600px"},s.a.createElement(Fa,null)),s.a.createElement(l.a,{marginTop:"16px",maxWidth:"400px"},s.a.createElement(Ha,null)),m&&s.a.createElement(l.a,{marginTop:"16px",maxWidth:"400px"},s.a.createElement(nt,{jobType:m})),m&&s.a.createElement(l.a,{marginTop:"32px",maxWidth:"400px"},s.a.createElement(za,{jobType:m})),o&&s.a.createElement(l.a,{marginTop:"32px",maxWidth:"600px"},s.a.createElement(Aa,{submitError:r})),s.a.createElement("div",{className:ot.a.formButtonContainer},s.a.createElement(l.b,{primary:!0,type:"submit",disabled:a||t,icon:u,className:ot.a.saveButton},O.a.t("Save")),s.a.createElement(fa,{shouldConfirm:!a},O.a.t("Cancel"))))},{func:dt,bool:mt,object:ut,array:pt}=c.a;it.defaultProps={submitError:[]};var bt=it;const{Form:Et}=l.y,{func:ht}=c.a;var gt=({setIsPristine:e})=>{const[a]=Ta();return s.a.createElement(Et,{onSubmit:a,component:bt,setIsPristine:e,destroyOnUnregister:!0})},_t=t(216),yt=t.n(_t);const{useForm:ft}=l.y,vt=({id:e,refetchJobs:a,handleSubmit:t,pristine:r,submitting:o,submitError:c,hasSubmitErrors:i,values:d,setIsPristine:m})=>{const{subscribe:u}=ft();Object(n.useEffect)(()=>u(({pristine:e})=>m(e),{pristine:!0}));const p=d[st],b=o?s.a.createElement(l.g,{small:!0}):null;return s.a.createElement("form",{onSubmit:t},s.a.createElement(l.a,{maxWidth:"600px"},s.a.createElement(Fa,null)),s.a.createElement(l.a,{marginTop:"16px",maxWidth:"400px"},s.a.createElement(Ha,null)),p&&s.a.createElement(l.a,{marginTop:"16px",maxWidth:"400px"},s.a.createElement(nt,{jobType:p})),p&&s.a.createElement(l.a,{marginTop:"32px",maxWidth:"400px"},s.a.createElement(za,{jobType:p})),i&&s.a.createElement(l.a,{marginTop:"32px",maxWidth:"600px"},s.a.createElement(Aa,{submitError:c})),s.a.createElement("div",{className:yt.a.formButtonContainer},s.a.createElement(l.b,{primary:!0,type:"submit",disabled:r||o,icon:b,className:yt.a.saveButton},O.a.t("Save")),s.a.createElement(fa,{shouldConfirm:!r},O.a.t("Cancel")),s.a.createElement("span",{className:yt.a.deleteButton},s.a.createElement(ha,{id:e,onSuccess:()=>{K.push("/"),a()}}))))},{func:xt,bool:jt,object:Tt,array:Ct,string:Nt}=c.a;vt.defaultProps={submitError:[]};var St=vt;const{Form:Ot}=l.y,Lt=["cronExpression","delay","jobParameters","jobType","name","schedulingType"],{func:At}=c.a;var Jt=({setIsPristine:e})=>{const{id:a}=Object(o.e)(),[t]=Na({id:a}),n=r.useRefetchJobs(),l=r.useJob(a),c=Lt.reduce((e,a)=>(e[a]=l[a],e),{});return s.a.createElement(Ot,{onSubmit:t,component:St,setIsPristine:e,initialValues:c,id:a,refetchJobs:n,destroyOnUnregister:!0})},kt=t(217),Ft=t.n(kt);const{string:wt}=c.a;var It=({created:e,lastExecutedStatus:a,lastExecuted:t})=>{const r=Date.now(),n=Ce()(e).from(r),l=J[a],o=t?Ce()(t).from(r):"";return s.a.createElement("div",{className:Ft.a.wrapper},s.a.createElement("h4",{className:Ft.a.title},O.a.t("Job details")),s.a.createElement("div",{className:Ft.a.details},s.a.createElement("div",null,O.a.t("Created {{ createdFromNow }}.",{createdFromNow:n})),o&&s.a.createElement("div",null,O.a.t("Last run {{ lastRunFromNow }}.",{lastRunFromNow:o})),l&&s.a.createElement("div",null,O.a.t("Last run status: {{ translatedStatus }}.",{translatedStatus:l,nsSeparator:">"}))))},Ht=t(218),Rt=t.n(Ht);const{bool:Dt,func:Pt,string:Bt}=c.a;var Mt=({isPristine:e,setIsPristine:a,name:t,created:r,lastExecutedStatus:n,lastExecuted:o})=>s.a.createElement(s.a.Fragment,null,s.a.createElement("header",{className:Rt.a.pageHeader},s.a.createElement(fa,{shouldConfirm:!e,className:Rt.a.pageHeaderButton,small:!0},O.a.t("Back to all jobs")),s.a.createElement("h2",{className:Rt.a.pageHeaderTitle},O.a.t("Job: {{ name }}",{name:t,nsSeparator:">"}))),s.a.createElement(l.d,{className:Rt.a.card},s.a.createElement("header",{className:Rt.a.cardHeader},s.a.createElement("h3",{className:Rt.a.cardHeaderTitle},O.a.t("Configuration")),s.a.createElement("a",{href:"https://docs.dhis2.org/en/use/user-guides/dhis-core-version-236/maintaining-the-system/scheduling.html",className:Rt.a.cardHeaderLink,target:"_blank",rel:"noopener noreferrer"},s.a.createElement("span",{className:Rt.a.cardHeaderInfo},s.a.createElement(l.l,null)),O.a.t("About job configuration"))),s.a.createElement("div",{className:Rt.a.jobDetails},s.a.createElement(It,{created:r,lastExecutedStatus:n,lastExecuted:o})),s.a.createElement(Jt,{setIsPristine:a})));var Gt=()=>{const[e,a]=Object(n.useState)(!0),{id:t}=Object(o.e)(),l=r.useJob(t);return s.a.createElement(Mt,{isPristine:e,setIsPristine:a,name:l.name,created:l.created,lastExecutedStatus:l.lastExecutedStatus,lastExecuted:l.lastExecuted})},Ut=t(219),Vt=t.n(Ut);var Wt=()=>{const{id:e}=Object(o.e)(),{name:a,created:t,lastExecutedStatus:n,lastExecuted:c,jobType:i,cronExpression:d}=r.useJob(e);return s.a.createElement(s.a.Fragment,null,s.a.createElement("header",{className:Vt.a.pageHeader},s.a.createElement(fa,{className:Vt.a.pageHeaderButton,small:!0},O.a.t("Back to all jobs")),s.a.createElement("h2",{className:Vt.a.pageHeaderTitle},O.a.t("System job: {{ name }}",{name:a,nsSeparator:">"}))),s.a.createElement(l.d,{className:Vt.a.card},s.a.createElement("header",{className:Vt.a.cardHeader},s.a.createElement("h3",{className:Vt.a.cardHeaderTitle},O.a.t("Configuration")),s.a.createElement("a",{href:"https://docs.dhis2.org/en/use/user-guides/dhis-core-version-236/maintaining-the-system/scheduling.html",className:Vt.a.cardHeaderLink,target:"_blank",rel:"noopener noreferrer"},s.a.createElement("span",{className:Vt.a.cardHeaderInfo},s.a.createElement(l.l,null)),O.a.t("About job configuration"))),s.a.createElement("div",{className:Vt.a.jobDetails},s.a.createElement(It,{created:t,lastExecutedStatus:n,lastExecuted:c})),s.a.createElement(l.a,{maxWidth:"600px"},s.a.createElement(l.m,{label:O.a.t("Name"),disabled:!0,value:a})),s.a.createElement(l.a,{marginTop:"16px",maxWidth:"400px"},s.a.createElement(l.z,{label:O.a.t("Job type"),disabled:!0,selected:i},s.a.createElement(l.B,{value:i,label:A[i]}))),s.a.createElement(l.a,{marginTop:"16px",maxWidth:"400px"},s.a.createElement(l.m,{label:O.a.t("CRON Expression"),disabled:!0,value:d,helpText:Ge(d)})),s.a.createElement(l.a,{marginTop:"24px"},s.a.createElement(fa,null,O.a.t("Back to all jobs")))))},Yt=t(220),qt=t.n(Yt);const{bool:zt,func:Zt}=c.a;var Xt=({isPristine:e,setIsPristine:a})=>s.a.createElement(s.a.Fragment,null,s.a.createElement("header",{className:qt.a.pageHeader},s.a.createElement(fa,{shouldConfirm:!e,className:qt.a.pageHeaderButton,small:!0},O.a.t("Back to all jobs")),s.a.createElement("h2",{className:qt.a.pageHeaderTitle},O.a.t("New Job"))),s.a.createElement(l.d,{className:qt.a.card},s.a.createElement("header",{className:qt.a.cardHeader},s.a.createElement("h3",{className:qt.a.cardHeaderTitle},O.a.t("Configuration")),s.a.createElement("a",{href:"https://docs.dhis2.org/en/use/user-guides/dhis-core-version-236/maintaining-the-system/scheduling.html",className:qt.a.cardHeaderLink,target:"_blank",rel:"noopener noreferrer"},s.a.createElement("span",{className:qt.a.cardHeaderInfo},s.a.createElement(l.l,null)),O.a.t("About job configuration"))),s.a.createElement(gt,{setIsPristine:a})));var Kt=()=>{const[e,a]=Object(n.useState)(!0);return s.a.createElement(Xt,{isPristine:e,setIsPristine:a})};var Qt=()=>s.a.createElement(o.b,{history:K},s.a.createElement(o.a,{exact:!0,path:"/",component:ia}),s.a.createElement(o.a,{path:"/edit/:id",component:Gt}),s.a.createElement(o.a,{path:"/view/:id",component:Wt}),s.a.createElement(o.a,{path:"/add",component:Kt}));var $t=t(221),er=t.n($t);const ar={me:{resource:"me"}},{node:tr}=c.a;var rr=({children:e})=>{const{loading:a,error:t,data:r}=Object(i.e)(ar);if(a)return s.a.createElement(l.o,null,s.a.createElement(l.e,null,s.a.createElement(l.g,null)));if(t)throw t;return(e=>{const{authorities:a}=e;return!!a&&(a.includes("ALL")||a.includes("F_SCHEDULING_ADMIN"))})(r.me)?s.a.createElement(s.a.Fragment,null,e):s.a.createElement("div",{className:er.a.noticeBoxWrapper},s.a.createElement(l.w,{error:!0,title:O.a.t("Not authorized")},O.a.t("You don't have access to the Job Scheduler. Contact a system administrator to request access.")))},nr=t(222),sr=t.n(nr);const{node:lr}=c.a;var or=({children:e})=>s.a.createElement("div",{className:sr.a.wrapper},e);t(223);var cr=()=>s.a.createElement(s.a.Fragment,null,s.a.createElement(l.h,{spacers:!0,colors:!0}),s.a.createElement(or,null,s.a.createElement(rr,null,s.a.createElement(E,null,s.a.createElement(Qt,null)))));t.d(a,"default",(function(){return cr}))}}]);
//# sourceMappingURL=app.011acb0b.chunk.js.map