(this["webpackJsonp@dhis2/app-shell"]=this["webpackJsonp@dhis2/app-shell"]||[]).push([[127],{203:function(e,t,a){e.exports={header:"JobList_header__23tFt",headerTitle:"JobList_headerTitle__21D__",headerLink:"JobList_headerLink__2zepi",headerLinkIcon:"JobList_headerLinkIcon__XdfBB",controlContainer:"JobList_controlContainer__3Yzj_",controlRight:"JobList_controlRight__38lfB"}},204:function(e,t,a){e.exports={list:"FormErrorBox_list__3BejY"}},205:function(e,t,a){e.exports={headerTitle:"ParameterFields_headerTitle__IBF76"}},206:function(e,t,a){e.exports={formButtonContainer:"JobAddForm_formButtonContainer__1MLSp",saveButton:"JobAddForm_saveButton__RfxZ9"}},207:function(e,t,a){e.exports={formButtonContainer:"JobEditForm_formButtonContainer__2b6Fi",deleteButton:"JobEditForm_deleteButton__VQxBE",saveButton:"JobEditForm_saveButton__278Ab"}},214:function(e,t,a){e.exports={wrapper:"JobDetails_wrapper__1-YkO",title:"JobDetails_title__1Cht7",details:"JobDetails_details__2HITJ"}},215:function(e,t,a){e.exports={pageHeader:"JobEdit_pageHeader__3Fywp",pageHeaderButton:"JobEdit_pageHeaderButton__29yjJ",pageHeaderTitle:"JobEdit_pageHeaderTitle__jZrIG",card:"JobEdit_card__2QqEg",cardHeader:"JobEdit_cardHeader__Mv_cj",cardHeaderTitle:"JobEdit_cardHeaderTitle__29Y64",cardHeaderInfo:"JobEdit_cardHeaderInfo__3VWZt",cardHeaderLink:"JobEdit_cardHeaderLink__2frj7",jobDetails:"JobEdit_jobDetails__194v-"}},216:function(e,t,a){e.exports={pageHeader:"JobAdd_pageHeader__2NZzc",pageHeaderButton:"JobAdd_pageHeaderButton__Xg_R9",pageHeaderTitle:"JobAdd_pageHeaderTitle__1RMl0",card:"JobAdd_card__1HH6H",cardHeader:"JobAdd_cardHeader__1D3sS",cardHeaderTitle:"JobAdd_cardHeaderTitle__2TG9a",cardHeaderInfo:"JobAdd_cardHeaderInfo__vq_Y1",cardHeaderLink:"JobAdd_cardHeaderLink__2CzPt"}},217:function(e,t,a){e.exports={noticeBoxWrapper:"AuthWall_noticeBoxWrapper__1ums5"}},218:function(e,t,a){e.exports={wrapper:"PageWrapper_wrapper__t-CJy"}},219:function(e,t,a){},224:function(e,t,a){"use strict";a.r(t);var r={};a.r(r),a.d(r,"getJobsStore",(function(){return g})),a.d(r,"getJobTypesStore",(function(){return _})),a.d(r,"getParameterOptionsStore",(function(){return f})),a.d(r,"getRefetchJobs",(function(){return y})),a.d(r,"getJobById",(function(){return v})),a.d(r,"getJobType",(function(){return T})),a.d(r,"getJobTypeParameters",(function(){return j})),a.d(r,"getParameterOptions",(function(){return C}));var n={};a.r(n),a.d(n,"useJobs",(function(){return N})),a.d(n,"useJobFilter",(function(){return S})),a.d(n,"useShowSystemJobs",(function(){return O})),a.d(n,"useListJobs",(function(){return x}));var o=a(1),l=a.n(o),s=a(180),c=a(208),i=a(181),m=a(13);var u=Object(o.createContext)({jobs:{},jobTypes:{},parameterOptions:{},refetchJobs:()=>{throw new Error("Store context needs a valid provider")}});const d={jobs:{resource:"jobConfigurations",params:{fields:"*",paging:!1}}},E={jobTypes:{resource:"jobConfigurations/jobTypes",params:{fields:"*",paging:!1}}},p={skipTableTypes:{resource:"analytics/tableTypes"},validationRuleGroups:{resource:"validationRuleGroups",params:{paging:!1}},pushAnalysis:{resource:"pushAnalysis",params:{paging:!1}},predictors:{resource:"predictors",params:{paging:!1}},predictorGroups:{resource:"predictorGroups",params:{paging:!1}}},{node:b}=i.a;var h=({children:e})=>{const t=Object(o.useState)(""),a=Object(o.useState)(!1),r=Object(m.e)(d),n=Object(m.e)(E),c=Object(m.e)(p);if(r.loading||n.loading||c.loading)return l.a.createElement(s.o,null,l.a.createElement(s.e,null,l.a.createElement(s.g,null)));const i=r.error||n.error||c.error;if(i)throw i;const{jobConfigurations:b}=r.data.jobs,{jobTypes:h}=n.data.jobTypes,{skipTableTypes:g,validationRuleGroups:{validationRuleGroups:_},pushAnalysis:{pushAnalysis:f},predictors:{predictors:y},predictorGroups:{predictorGroups:v}}=c.data,T={skipTableTypes:g,validationRuleGroups:_,pushAnalysis:f,predictors:y,predictorGroups:v};return l.a.createElement(u.Provider,{value:{jobs:b,jobTypes:h,parameterOptions:T,refetchJobs:r.refetch,jobFilter:t,showSystemJobs:a}},e)};const g=e=>e.jobs,_=e=>e.jobTypes,f=e=>e.parameterOptions,y=e=>e.refetchJobs,v=(e,t)=>g(e).find(e=>e.id===t),T=(e,t)=>_(e).find(e=>e.jobType===t),j=(e,t)=>{const a=T(e,t);return"jobParameters"in a?a.jobParameters:[]},C=(e,t)=>f(e)[t],N=()=>Object(o.useContext)(u).jobs,S=()=>Object(o.useContext)(u).jobFilter,O=()=>Object(o.useContext)(u).showSystemJobs,x=()=>{const[e]=S(),[t]=O();return N().filter(t=>t.name.toLowerCase().includes(e.toLowerCase())).filter(e=>!!t||e.configurable)};var A=a(8),J=a.n(A),R=a(193);var I=Object(R.a)();var F={DATA_VALUE:J.a.t("Data value"),COMPLETENESS:J.a.t("Completeness"),COMPLETENESS_TARGET:J.a.t("Completeness target"),ORG_UNIT_TARGET:J.a.t("Org unit target"),EVENT:J.a.t("Event"),ENROLLMENT:J.a.t("Enrollment"),VALIDATION_RESULT:J.a.t("Validation result")};var D={ANALYTICS_TABLE:J.a.t("Analytics table"),CONTINUOUS_ANALYTICS_TABLE:J.a.t("Continuous analytics table"),CREDENTIALS_EXPIRY_ALERT:J.a.t("Credentials expiry alert"),DATA_INTEGRITY:J.a.t("Data integrity"),DATA_SET_NOTIFICATION:J.a.t("Dataset notification"),DATA_STATISTICS:J.a.t("Data statistics"),DATA_SYNC:J.a.t("Data synchronization"),EVENT_PROGRAMS_DATA_SYNC:J.a.t("Event programs data sync"),FILE_RESOURCE_CLEANUP:J.a.t("File resource clean up"),META_DATA_SYNC:J.a.t("Metadata synchronization"),MONITORING:J.a.t("Monitoring"),PREDICTOR:J.a.t("Predictor"),PROGRAM_NOTIFICATIONS:J.a.t("Program notifications"),PUSH_ANALYSIS:J.a.t("Push analysis"),REMOVE_EXPIRED_RESERVED_VALUES:J.a.t("Remove expired reserved values"),RESOURCE_TABLE:J.a.t("Resource table"),SEND_SCHEDULED_MESSAGE:J.a.t("Send scheduled message"),TRACKER_PROGRAMS_DATA_SYNC:J.a.t("Tracker programs data sync"),VALIDATION_RESULTS_NOTIFICATION:J.a.t("Validation results notification")};var L={COMPLETED:J.a.t("Completed"),DISABLED:J.a.t("Disabled"),DONE:J.a.t("Done"),FAILED:J.a.t("Failed"),NOT_STARTED:J.a.t("Not started"),RUNNING:J.a.t("Running"),SCHEDULED:J.a.t("Scheduled"),STOPPED:J.a.t("Stopped")};const k={resource:"jobConfigurations",id:({id:e})=>e,type:"update",partial:!0,data:({enabled:e})=>({enabled:e})},{bool:P,string:H}=i.a;var w=({id:e,checked:t})=>{const[a,{loading:n}]=Object(m.d)(k),c=Object(o.useContext)(u),i=r.getRefetchJobs(c),d=!t;return l.a.createElement(s.A,{name:"toggle-job-".concat(e),disabled:n,checked:t,onChange:()=>{a({id:e,enabled:d}).then(()=>i())}})};const{string:B}=i.a;var M=({id:e})=>l.a.createElement(s.p,{dense:!0,onClick:()=>I.push("/edit/".concat(e)),label:J.a.t("Edit")});const G=[{label:J.a.t("Every hour"),value:"0 0 * ? * *"},{label:J.a.t("Every day at midnight"),value:"0 0 1 ? * *"},{label:J.a.t("Every day at 3 am"),value:"0 0 3 ? * *"},{label:J.a.t("Every day at noon"),value:"0 0 12 ? * MON-FRI"},{label:J.a.t("Every week"),value:"0 0 3 ? * MON"}],{func:U}=i.a;var Y=({setCron:e,hideModal:t})=>{const[a,r]=Object(o.useState)("");return l.a.createElement(s.q,{open:!0,small:!0,onClose:t},l.a.createElement(s.t,null,J.a.t("Choose a preset time/interval")),l.a.createElement(s.s,null,G.map(e=>l.a.createElement(s.x,Object.assign({},e,{checked:a===e.value,key:e.value,onChange:({value:e})=>r(e)})))),l.a.createElement(s.r,null,l.a.createElement(s.c,{end:!0},l.a.createElement(s.b,{secondary:!0,onClick:t,name:"hide-modal"},J.a.t("Cancel")),l.a.createElement(s.b,{primary:!0,name:"insert-preset",disabled:!a,onClick:()=>{t(),e(a)}},J.a.t("Insert preset")))))};const W={resource:"jobConfigurations",id:({id:e})=>e,type:"delete"},{func:q,string:V}=i.a;var z=({id:e,hideModal:t,onSuccess:a})=>{const[r]=Object(m.d)(W);return l.a.createElement(s.q,{open:!0,small:!0,onClose:t},l.a.createElement(s.s,null,J.a.t("Are you sure you want to delete this job?")),l.a.createElement(s.r,null,l.a.createElement(s.c,{end:!0},l.a.createElement(s.b,{name:"hide-modal",secondary:!0,onClick:t},J.a.t("Cancel")),l.a.createElement(s.b,{name:"delete-job-".concat(e),destructive:!0,onClick:()=>{r({id:e}).then(()=>{t(),a()})}},J.a.t("Delete")))))};const{func:X}=i.a;var K=({hideModal:e})=>l.a.createElement(s.q,{open:!0,small:!0,onClose:e},l.a.createElement(s.s,null,J.a.t("Are you sure you want to discard this form?")),l.a.createElement(s.r,null,l.a.createElement(s.c,{end:!0},l.a.createElement(s.b,{name:"cancel-discard-form",secondary:!0,onClick:e},J.a.t("Cancel")),l.a.createElement(s.b,{name:"discard-form",destructive:!0,onClick:()=>{e(),I.push("/")}},J.a.t("Discard")))));const{func:Z,string:Q}=i.a;var $=({id:e,hideModal:t})=>{const a=Object(m.c)(),n={jobs:{resource:"jobConfigurations/".concat(e,"/execute")}},c=Object(o.useContext)(u),i=r.getRefetchJobs(c);return l.a.createElement(s.q,{open:!0,small:!0,onClose:t},l.a.createElement(s.s,null,J.a.t("Are you sure you want to run this job?")),l.a.createElement(s.r,null,l.a.createElement(s.c,{end:!0},l.a.createElement(s.b,{name:"hide-modal",secondary:!0,onClick:t},J.a.t("Cancel")),l.a.createElement(s.b,{name:"run-job-".concat(e),primary:!0,onClick:()=>{a.query(n).then(()=>{t(),i()})}},J.a.t("Run")))))};const{string:ee}=i.a;var te=({id:e})=>{const[t,a]=Object(o.useState)(!1);return l.a.createElement(l.a.Fragment,null,l.a.createElement(s.p,{dense:!0,onClick:()=>{a(!0)},label:J.a.t("Run manually")}),t&&l.a.createElement($,{id:e,hideModal:()=>a(!1)}))};const{string:ae}=i.a;var re=({id:e})=>{const[t,a]=Object(o.useState)(!1),n=Object(o.useContext)(u),c=r.getRefetchJobs(n);return l.a.createElement(l.a.Fragment,null,l.a.createElement(s.p,{dense:!0,destructive:!0,onClick:()=>{a(!0)},label:J.a.t("Delete")}),t&&l.a.createElement(z,{id:e,hideModal:()=>a(!1),onSuccess:c}))};const ne=({id:e,configurable:t})=>l.a.createElement(s.i,{small:!0,component:l.a.createElement(s.k,null,t&&l.a.createElement(M,{id:e}),l.a.createElement(te,{id:e}),l.a.createElement(re,{id:e}))},J.a.t("Actions"));ne.defaultProps={configurable:!1};const{string:oe,bool:le}=i.a;var se=ne;const{string:ce}=i.a;var ie=({status:e})=>{switch(e){case"STOPPED":case"DISABLED":return l.a.createElement(s.J,null,L[e]);case"RUNNING":case"NOT_STARTED":case"SCHEDULED":return l.a.createElement(s.J,{neutral:!0},L[e]);case"FAILED":return l.a.createElement(s.J,{negative:!0},L[e]);case"DONE":return l.a.createElement(s.J,{positive:!0},L[e]);default:return null}},me=a(27),ue=a.n(me);const de=({nextExecutionTime:e,enabled:t})=>{if(!t||!e)return"-";const a=ue()(Date.now()),r=ue.a.utc(e);return r.isSameOrBefore(a,"minute")?J.a.t("Not scheduled"):a.to(r)},{bool:Ee,string:pe}=i.a;de.propTypes={enabled:Ee.isRequired,nextExecutionTime:pe};var be=de,he=a(201),ge=a.n(he);const _e=["MON","TUE","WED","THU","FRI","SAT","SUN"],fe=["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],ye=(e,t,a)=>e>=t&&e<=a,ve=e=>"*"===e,Te=e=>"?"===e,je=(e,t,a)=>ve(e)||ye(e,t,a)||((e,t,a)=>{const r=e.split("-");return!(!r||2!==r.length)&&(ye(r[0],t,a)&&ye(r[1],t,a)&&r[0]<=r[1])})(e,t,a)||((e,t,a)=>{const r=e.split("/");return!(!r||2!==r.length)&&((ve(r[0])||ye(r[0],t,a))&&ye(r[1],t,a))})(e,t,a),Ce=e=>je(e,1,12)||(e=>{const t=e.split("-"),[a,r]=t.map(e=>fe.indexOf(e));return-1!==a&&void 0===r||-1!==a&&-1!==r&&a<=r})(e),Ne=e=>je(e,1,7)||(e=>{const t=e.split("-"),[a,r]=t.map(e=>_e.indexOf(e));return-1!==a&&void 0===r||-1!==a&&-1!==r&&a<=r})(e)||Te(e);var Se=e=>{if(!e)return!1;const t=e.trim().split(" ");return!!(e=>e&&6===e.length)(t)&&(a=t[0],je(a,0,59)&&(e=>je(e,0,59))(t[1])&&(e=>je(e,0,23))(t[2])&&(e=>je(e,0,31)||Te(e))(t[3])&&Ce(t[4])&&Ne(t[5]));var a};var Oe=e=>"string"===typeof e&&e.length>0?Se(e)?void 0:J.a.t("Please enter a valid CRON expression"):J.a.t("A CRON expression is required");var xe=e=>{const t=J.a.language||"en";return e&&Se(e)?ge.a.toString(e,{locale:t}):""};const Ae=({cronExpression:e,schedulingType:t,delay:a})=>{switch(t){case"CRON":return xe(e);case"FIXED_DELAY":return J.a.t("{{ delay }} seconds after last run",{delay:a});default:return"-"}},{string:Je,number:Re}=i.a;Ae.propTypes={schedulingType:Je.isRequired,cronExpression:Je,delay:Re};var Ie=Ae;const{shape:Fe,string:De,bool:Le,number:ke}=i.a;var Pe=({job:{id:e,displayName:t,jobType:a,cronExpression:r,delay:n,jobStatus:o,nextExecutionTime:c,schedulingType:i,enabled:m,configurable:u}})=>l.a.createElement(s.H,null,l.a.createElement(s.E,null,t),l.a.createElement(s.E,null,D[a]),l.a.createElement(s.E,null,l.a.createElement(Ie,{cronExpression:r,delay:n,schedulingType:i})),l.a.createElement(s.E,null,l.a.createElement(be,{nextExecutionTime:c,enabled:m})),l.a.createElement(s.E,null,l.a.createElement(ie,{status:o})),l.a.createElement(s.E,null,l.a.createElement(w,{id:e,checked:m})),l.a.createElement(s.E,null,l.a.createElement(se,{id:e,configurable:u})));const{object:He,arrayOf:we}=i.a;var Be=({jobs:e})=>l.a.createElement(s.C,null,l.a.createElement(s.G,null,l.a.createElement(s.I,null,l.a.createElement(s.F,null,J.a.t("Job name")),l.a.createElement(s.F,null,J.a.t("Type")),l.a.createElement(s.F,null,J.a.t("Schedule")),l.a.createElement(s.F,null,J.a.t("Next run")),l.a.createElement(s.F,null,J.a.t("Status")),l.a.createElement(s.F,null,J.a.t("On/off")),l.a.createElement(s.F,null))),l.a.createElement(s.D,null,0===e.length?l.a.createElement(s.H,null,l.a.createElement(s.E,null,J.a.t("No jobs to display"))):e.map(e=>l.a.createElement(Pe,{key:e.id,job:e})))),Me=a(203),Ge=a.n(Me);const{bool:Ue,object:Ye,string:We,arrayOf:qe,func:Ve}=i.a;var ze=({jobs:e,showSystemJobs:t,setShowSystemJobs:a,jobFilter:r,setJobFilter:n})=>l.a.createElement(l.a.Fragment,null,l.a.createElement("header",{className:Ge.a.header},l.a.createElement("h1",{className:Ge.a.headerTitle},J.a.t("Scheduled jobs")),l.a.createElement("a",{href:"https://docs.dhis2.org/master/en/user/html/dataAdmin_scheduling.html#dataAdmin_scheduling_config",className:Ge.a.headerLink,target:"_blank",rel:"noopener noreferrer"},l.a.createElement("span",{className:Ge.a.headerLinkIcon},l.a.createElement(s.l,null)),J.a.t("About job configuration"))),l.a.createElement(s.d,null,l.a.createElement("div",{className:Ge.a.controlContainer},l.a.createElement(s.m,{dataTest:"job-filter-input",placeholder:J.a.t("Filter jobs"),onChange:({value:e})=>{n(e)},value:r}),l.a.createElement("div",{className:Ge.a.controlRight},l.a.createElement(s.f,{dataTest:"job-toggle-checkbox",checked:t,label:J.a.t("Include system jobs in list"),onChange:({checked:e})=>{a(e)}}),l.a.createElement(s.b,{dataTest:"new-job-button",onClick:()=>{I.push("/add")}},J.a.t("New job")))),l.a.createElement(Be,{jobs:e})));var Xe=()=>{const[e,t]=n.useJobFilter(),[a,r]=n.useShowSystemJobs(),o=n.useListJobs();return l.a.createElement(ze,{jobs:o,showSystemJobs:a,setShowSystemJobs:r,jobFilter:e,setJobFilter:t})};const Ke=({setCron:e,small:t})=>{const[a,r]=Object(o.useState)(!1);return l.a.createElement(l.a.Fragment,null,l.a.createElement(s.b,{onClick:()=>r(!0),small:t},J.a.t("Choose from preset times")),a&&l.a.createElement(Y,{hideModal:()=>r(!1),setCron:e}))};Ke.defaultProps={small:!1};const{func:Ze,bool:Qe}=i.a;var $e=Ke;const{string:et,func:tt}=i.a;var at=({id:e,onSuccess:t})=>{const[a,r]=Object(o.useState)(!1);return l.a.createElement(l.a.Fragment,null,l.a.createElement(s.b,{destructive:!0,onClick:()=>r(!0)},J.a.t("Delete job")),a&&l.a.createElement(z,{id:e,hideModal:()=>r(!1),onSuccess:t}))};const rt=({shouldConfirm:e,children:t,small:a,className:r})=>{const[n,c]=Object(o.useState)(!1),i=e?()=>c(!0):()=>I.push("/");return l.a.createElement(l.a.Fragment,null,l.a.createElement(s.b,{onClick:i,small:a,className:r},t),n&&l.a.createElement(K,{hideModal:()=>c(!1)}))};rt.defaultProps={className:"",shouldConfirm:!1,small:!1};const{string:nt,bool:ot}=i.a;var lt=rt;const{FORM_ERROR:st}=s.j;var ct=e=>{const{details:{response:t}}=e,a={},r=[];return t.errorReports&&t.errorReports.length&&t.errorReports.forEach(e=>{e.errorProperty?a[e.errorProperty]=e.message:r.push(e.message)}),r.length>0&&(a[st]=r),a};const it={resource:"jobConfigurations",type:"create",data:({job:e})=>e};var mt=()=>{const{refetchJobs:e}=Object(o.useContext)(u),t=Object(m.c)();return[a=>t.mutate(it,{variables:{job:a}}).then(()=>{I.push("/"),e()}).catch(e=>{if("access"===e.type)return ct(e);throw e})]};const ut={resource:"jobConfigurations",type:"update",id:({id:e})=>e,data:({job:e})=>e};var dt=({id:e})=>{const{refetchJobs:t}=Object(o.useContext)(u),a=Object(m.c)();return[r=>a.mutate(ut,{variables:{job:r,id:e}}).then(()=>{I.push("/"),t()}).catch(e=>{if("access"===e.type)return ct(e);throw e})]},Et=a(204),pt=a.n(Et);const{array:bt}=i.a;var ht=({submitError:e})=>e.length>0?l.a.createElement(s.w,{error:!0,title:J.a.t("Something went wrong whilst creating your job")},l.a.createElement("ul",{className:pt.a.list},e.map(e=>l.a.createElement("li",{key:e},e)))):null;const{Field:gt}=s.y,_t=Object(s.K)(s.O,s.M);var ft=()=>l.a.createElement(gt,{name:"name",component:s.n,validate:_t,label:J.a.t("Name"),type:"text",required:!0});const{Field:yt}=s.y,vt=Object(s.K)(s.O,s.M);var Tt=()=>{const e=Object(o.useContext)(u),t=r.getJobTypesStore(e).map(({jobType:e})=>({value:e,label:D[e]}));return l.a.createElement(yt,{name:"jobType",validate:vt,component:s.z,options:t,label:J.a.t("Job type"),required:!0})};const jt=e=>"number"===typeof e?e.toString():e,{Field:Ct}=s.y,{string:Nt}=i.a;var St=({label:e,name:t,parameterName:a})=>{const n=Object(o.useContext)(u),c=r.getParameterOptions(n,a);if(0===c.length)return l.a.createElement(s.u,{disabled:!0,helpText:J.a.t("No options available"),label:e});const i=c.map(e=>({value:e,label:F[e]||e}));return l.a.createElement(Ct,{name:t,component:s.v,options:i,label:e})};const{Field:Ot}=s.y,{string:xt}=i.a;var At=({label:e,name:t,parameterName:a})=>{const n=Object(o.useContext)(u),c=r.getParameterOptions(n,a);if(0===c.length)return l.a.createElement(s.u,{disabled:!0,helpText:J.a.t("No options available"),label:e});const i=c.map(({id:e,displayName:t})=>({value:e,label:t}));return l.a.createElement(Ot,{name:t,component:s.v,options:i,label:e})},Jt=a(205),Rt=a.n(Jt);const{Field:It}=s.y,{string:Ft}=i.a;var Dt=({jobType:e})=>{const t=Object(o.useContext)(u),a=r.getJobTypeParameters(t,e);if(0===a.length)return null;const n=a.map(({fieldName:e,name:t,klass:a})=>{const r={label:e,name:"".concat("jobParameters",".").concat(t)};let n=null;if("skipTableTypes"===t)return l.a.createElement(s.a,{marginTop:"16px",key:t},l.a.createElement(St,Object.assign({},r,{parameterName:t})));switch(a){case"java.lang.String":n=l.a.createElement(It,Object.assign({},r,{component:s.n,type:"text"}));break;case"java.lang.Boolean":n=l.a.createElement(It,Object.assign({},r,{component:s.B,type:"checkbox"}));break;case"java.lang.Integer":n=l.a.createElement(It,Object.assign({},r,{component:s.n,format:jt,type:"number"}));break;case"java.util.List":n=l.a.createElement(At,Object.assign({},r,{parameterName:t}))}return l.a.createElement(s.a,{marginTop:"16px",key:t},n)});return l.a.createElement(l.a.Fragment,null,l.a.createElement("header",null,l.a.createElement("h4",{className:Rt.a.headerTitle},J.a.t("Parameters"))),n)};const{Field:Lt,useFormState:kt,useForm:Pt}=s.y,Ht=Oe;var wt=()=>{const e=Pt(),{values:t}=kt({subscription:{values:!0}}),a=t.cronExpression,r=xe(a);return l.a.createElement(l.a.Fragment,null,l.a.createElement(Lt,{component:s.n,name:"cronExpression",validate:Ht,label:J.a.t("CRON Expression"),type:"text",helpText:r,required:!0}),l.a.createElement(s.a,{marginTop:"8px"},l.a.createElement($e,{setCron:t=>e.change("cronExpression",t),small:!0})))};const{Field:Bt}=s.y,Mt=Object(s.K)(s.N,s.M,Object(s.L)(1,86400));var Gt=()=>l.a.createElement(Bt,{component:s.n,name:"delay",validate:Mt,label:J.a.t("Delay"),type:"number",format:jt,helpText:J.a.t("Delay in seconds ({{ lowerbound }} - {{ upperbound }})",{lowerbound:1,upperbound:86400}),required:!0});const{string:Ut}=i.a;var Yt=({jobType:e})=>{const t=Object(o.useContext)(u);switch(r.getJobType(t,e).schedulingType){case"CRON":return l.a.createElement(wt,null);case"FIXED_DELAY":return l.a.createElement(Gt,null);default:return null}};const Wt="jobType";var qt=a(206),Vt=a.n(qt);const{useForm:zt}=s.y,Xt=({handleSubmit:e,pristine:t,submitting:a,submitError:r,hasSubmitErrors:n,values:c,setIsPristine:i})=>{const{subscribe:m}=zt();Object(o.useEffect)(()=>m(({pristine:e})=>i(e),{pristine:!0}));const u=c[Wt],d=a?l.a.createElement(s.g,{small:!0}):null;return l.a.createElement("form",{onSubmit:e},l.a.createElement(s.a,{maxWidth:"600px"},l.a.createElement(ft,null)),l.a.createElement(s.a,{marginTop:"16px",maxWidth:"400px"},l.a.createElement(Tt,null)),u&&l.a.createElement(s.a,{marginTop:"16px",maxWidth:"400px"},l.a.createElement(Yt,{jobType:u})),u&&l.a.createElement(s.a,{marginTop:"32px",maxWidth:"400px"},l.a.createElement(Dt,{jobType:u})),n&&l.a.createElement(s.a,{marginTop:"32px",maxWidth:"600px"},l.a.createElement(ht,{submitError:r})),l.a.createElement("div",{className:Vt.a.formButtonContainer},l.a.createElement(s.b,{primary:!0,type:"submit",disabled:t||a,icon:d,className:Vt.a.saveButton},J.a.t("Save")),l.a.createElement(lt,{shouldConfirm:!t},J.a.t("Cancel"))))},{func:Kt,bool:Zt,object:Qt,array:$t}=i.a;Xt.defaultProps={submitError:[]};var ea=Xt;const{Form:ta}=s.y,{func:aa}=i.a;var ra=({setIsPristine:e})=>{const[t]=mt();return l.a.createElement(ta,{onSubmit:t,component:ea,setIsPristine:e,destroyOnUnregister:!0})},na=a(207),oa=a.n(na);const{useForm:la}=s.y,sa=({id:e,refetchJobs:t,handleSubmit:a,pristine:r,submitting:n,submitError:c,hasSubmitErrors:i,values:m,setIsPristine:u})=>{const{subscribe:d}=la();Object(o.useEffect)(()=>d(({pristine:e})=>u(e),{pristine:!0}));const E=m[Wt],p=n?l.a.createElement(s.g,{small:!0}):null;return l.a.createElement("form",{onSubmit:a},l.a.createElement(s.a,{maxWidth:"600px"},l.a.createElement(ft,null)),l.a.createElement(s.a,{marginTop:"16px",maxWidth:"400px"},l.a.createElement(Tt,null)),E&&l.a.createElement(s.a,{marginTop:"16px",maxWidth:"400px"},l.a.createElement(Yt,{jobType:E})),E&&l.a.createElement(s.a,{marginTop:"32px",maxWidth:"400px"},l.a.createElement(Dt,{jobType:E})),i&&l.a.createElement(s.a,{marginTop:"32px",maxWidth:"600px"},l.a.createElement(ht,{submitError:c})),l.a.createElement("div",{className:oa.a.formButtonContainer},l.a.createElement(s.b,{primary:!0,type:"submit",disabled:r||n,icon:p,className:oa.a.saveButton},J.a.t("Save")),l.a.createElement(lt,{shouldConfirm:!r},J.a.t("Cancel")),l.a.createElement("span",{className:oa.a.deleteButton},l.a.createElement(at,{id:e,onSuccess:()=>{I.push("/"),t()}}))))},{func:ca,bool:ia,object:ma,array:ua,string:da}=i.a;sa.defaultProps={submitError:[]};var Ea=sa;const{Form:pa}=s.y,ba=["cronExpression","delay","jobParameters","jobType","name","schedulingType"],{func:ha}=i.a;var ga=({setIsPristine:e})=>{const{id:t}=Object(c.c)(),[a]=dt({id:t}),n=Object(o.useContext)(u),s=r.getRefetchJobs(n),i=r.getJobById(n,t),m=ba.reduce((e,t)=>(e[t]=i[t],e),{});return l.a.createElement(pa,{onSubmit:a,component:Ea,setIsPristine:e,initialValues:m,id:t,refetchJobs:s,destroyOnUnregister:!0})},_a=a(214),fa=a.n(_a);const{string:ya}=i.a;var va=({created:e,lastExecutedStatus:t,lastExecuted:a})=>{const r=Date.now(),n=ue()(e).from(r),o=L[t],s=a?ue()(a).from(r):"";return l.a.createElement("div",{className:fa.a.wrapper},l.a.createElement("h4",{className:fa.a.title},J.a.t("Job details")),l.a.createElement("div",{className:fa.a.details},l.a.createElement("div",null,J.a.t("Created {{ createdFromNow }}.",{createdFromNow:n})),s&&l.a.createElement("div",null,J.a.t("Last run {{ lastRunFromNow }}.",{lastRunFromNow:s})),o&&l.a.createElement("div",null,J.a.t("Last run status: {{ translatedStatus }}.",{translatedStatus:o,nsSeparator:">"}))))},Ta=a(215),ja=a.n(Ta);const{bool:Ca,func:Na,string:Sa}=i.a;var Oa=({isPristine:e,setIsPristine:t,name:a,created:r,lastExecutedStatus:n,lastExecuted:o})=>l.a.createElement(l.a.Fragment,null,l.a.createElement("header",{className:ja.a.pageHeader},l.a.createElement(lt,{shouldConfirm:!e,className:ja.a.pageHeaderButton,small:!0},J.a.t("Back to all jobs")),l.a.createElement("h2",{className:ja.a.pageHeaderTitle},J.a.t("Job: {{ name }}",{name:a,nsSeparator:">"}))),l.a.createElement(s.d,{className:ja.a.card},l.a.createElement("header",{className:ja.a.cardHeader},l.a.createElement("h3",{className:ja.a.cardHeaderTitle},J.a.t("Configuration")),l.a.createElement("a",{href:"https://docs.dhis2.org/master/en/user/html/dataAdmin_scheduling.html#dataAdmin_scheduling_config",className:ja.a.cardHeaderLink,target:"_blank",rel:"noopener noreferrer"},l.a.createElement("span",{className:ja.a.cardHeaderInfo},l.a.createElement(s.l,null)),J.a.t("About job configuration"))),l.a.createElement("div",{className:ja.a.jobDetails},l.a.createElement(va,{created:r,lastExecutedStatus:n,lastExecuted:o})),l.a.createElement(ga,{setIsPristine:t})));var xa=()=>{const e=Object(o.useContext)(u),[t,a]=Object(o.useState)(!0),{id:n}=Object(c.c)(),s=r.getJobById(e,n);return l.a.createElement(Oa,{isPristine:t,setIsPristine:a,name:s.name,created:s.created,lastExecutedStatus:s.lastExecutedStatus,lastExecuted:s.lastExecuted})},Aa=a(216),Ja=a.n(Aa);const{bool:Ra,func:Ia}=i.a;var Fa=({isPristine:e,setIsPristine:t})=>l.a.createElement(l.a.Fragment,null,l.a.createElement("header",{className:Ja.a.pageHeader},l.a.createElement(lt,{shouldConfirm:!e,className:Ja.a.pageHeaderButton,small:!0},J.a.t("Back to all jobs")),l.a.createElement("h2",{className:Ja.a.pageHeaderTitle},J.a.t("New Job"))),l.a.createElement(s.d,{className:Ja.a.card},l.a.createElement("header",{className:Ja.a.cardHeader},l.a.createElement("h3",{className:Ja.a.cardHeaderTitle},J.a.t("Configuration")),l.a.createElement("a",{href:"https://docs.dhis2.org/master/en/user/html/dataAdmin_scheduling.html#dataAdmin_scheduling_config",className:Ja.a.cardHeaderLink,target:"_blank",rel:"noopener noreferrer"},l.a.createElement("span",{className:Ja.a.cardHeaderInfo},l.a.createElement(s.l,null)),J.a.t("About job configuration"))),l.a.createElement(ra,{setIsPristine:t})));var Da=()=>{const[e,t]=Object(o.useState)(!0);return l.a.createElement(Fa,{isPristine:e,setIsPristine:t})};var La=()=>l.a.createElement(c.b,{history:I},l.a.createElement(c.a,{exact:!0,path:"/",component:Xe}),l.a.createElement(c.a,{path:"/edit/:id",component:xa}),l.a.createElement(c.a,{path:"/add",component:Da}));var ka=a(217),Pa=a.n(ka);const Ha={me:{resource:"me"}},{node:wa}=i.a;var Ba=({children:e})=>{const{loading:t,error:a,data:r}=Object(m.e)(Ha);if(t)return l.a.createElement(s.o,null,l.a.createElement(s.e,null,l.a.createElement(s.g,null)));if(a)throw a;return(e=>{const{authorities:t}=e;return!!t&&(t.includes("ALL")||t.includes("F_SCHEDULING_ADMIN"))})(r.me)?l.a.createElement(l.a.Fragment,null,e):l.a.createElement("div",{className:Pa.a.noticeBoxWrapper},l.a.createElement(s.w,{error:!0,title:J.a.t("Not authorized")},J.a.t("You don't have access to the Job Scheduler. Contact a system administrator to request access.")))},Ma=a(218),Ga=a.n(Ma);const{node:Ua}=i.a;var Ya=({children:e})=>l.a.createElement("div",{className:Ga.a.wrapper},e);a(219);var Wa=()=>l.a.createElement(l.a.Fragment,null,l.a.createElement(s.h,{spacers:!0,colors:!0}),l.a.createElement(Ya,null,l.a.createElement(Ba,null,l.a.createElement(h,null,l.a.createElement(La,null)))));a.d(t,"default",(function(){return Wa}))}}]);
//# sourceMappingURL=app.a9223477.chunk.js.map